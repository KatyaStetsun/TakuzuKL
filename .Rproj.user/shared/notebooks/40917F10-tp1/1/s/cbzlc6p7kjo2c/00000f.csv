"0","# Функция для моделирования спроса"
"0","simulate_demand <- function(lambda) {"
"0","  return(rpois(1, lambda))"
"0","}"
"0",""
"0","# Функция для обновления состояния склада"
"0","update_state <- function(x, a, D) {"
"0","  return(max(0, x + a - D))"
"0","}"
"0",""
"0","# Функция для расчета награды"
"0","calculate_reward <- function(a, D, x) {"
"0","  return(-alpha * a - gamma * max(0, D - x - a))"
"0","}"
"0",""
"0","# Инициализация переменных"
"0","X <- numeric(N + 1)"
"0","Actions <- numeric(N)"
"0","rewards <- numeric(N)"
"0","X[1] <- x0"
"0",""
"0","# Моделирование траектории"
"0","for (t in 1:N) {"
"0","  # Моделирование спроса"
"0","  D <- simulate_demand(lambda_P)"
"0","  "
"0","  # Выбор действия (пополнение запасов)"
"0","  a <- max(0, M - X[t])"
"0","  "
"0","  # Обновление состояния"
"0","  X[t + 1] <- update_state(X[t], a, D)"
"0","  "
"0","  # Расчет награды"
"0","  rewards[t] <- calculate_reward(a, D, X[t])"
"0","  "
"0","  # Сохранение действия"
"0","  Actions[t] <- a"
"0","}"
