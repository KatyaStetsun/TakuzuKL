"0","# Расчет среднего и стандартного отклонения для каждого момента времени"
"0","df_summary <- df %>%"
"0","  group_by(time) %>%"
"0","  summarise("
"0","    mean_stock = mean(stock),"
"0","    sd_stock = sd(stock),"
"0","    ci_lower = mean_stock - qnorm(0.975) * (sd_stock / sqrt(num_traj_s)),"
"0","    ci_upper = mean_stock + qnorm(0.975) * (sd_stock / sqrt(num_traj_s))"
"0","  )"
"0",""
"0","# Визуализация с доверительным интервалом"
"0","ggplot(df_summary, aes(x = time, y = mean_stock)) +"
"0","  geom_line(size = 1, color = ""blue"") +"
"0","  geom_ribbon(aes(ymin = ci_lower, ymax = ci_upper), alpha = 0.2, fill = ""blue"") +  # Доверительный интервал"
"0","  geom_hline(yintercept = M, linetype = ""dashed"", color = ""red"", size = 1) +  # Линия для максимальной вместимости"
"0","  labs(title = ""Trajectoires de gestion de stock (Politique π1) avec intervalle de confiance"","
"0","       x = ""Temps"","
"0","       y = ""Stock disponible moyen"") +"
"0","  theme_minimal()"
